#includepath "~/Documents/;%USERPROFILE%Documents";
#include "basiljs/bundle/basil.js";

var rawData = "i feel good! zachbachiri Simultaneously inspired and frustrated - so much that it keeps me awake. zachbachiri Ready zachbachiri Lost zachbachiri I feel a little tired and hungry and stoned zachbachiri It varies, but currently alright. zachbachiri I cut my own hair yesterday and I really feel like no one really likes it. I feel real angry sometimes as well but also sometimes just the best, I'm not sure how I really feel but I hope that you feel happy. zachbachiri actually pretty good. been teaching music, playing a few shows and living in Austin texas. zachbachiri Sad. But ain't that how it always goes. zachbachiri idk rn I'm feeling pretty good zachbachiri Almost completely in love  zachbachiri i feel homesick or maybe just hungry zachbachiri Bloated and sad and medicated and fine zachbachiri Proud to be a Melbournian whenever I hear the talent that comes out of our city zachbachiri I little bit tired and hungry, but ready to get off work and have some fun. zachbachiri Right now I feel a little worn out from my kids not settling down tonight and letting my wife and I relax a bit after working all day.  zachbachiri Today will be a better day. If yesterday was good, then today will be just as good if not better. zachbachiri  Most days 'What you once were is not what you want to be, anymore' applies zachbachiri I got a toothache and just discovered I missed the new CB album announcement and have two new songs to listen to. Kinda making me forget about the toothache. zachbachiri Abandoned, but forced to go through the motions of belonging. zachbachiri stressed zachbachiri Lethargic and stuck zachbachiri A placeholder person for a clone or someone just like me zachbachiri I feel like im hiding from myself, hiding my love for art, hiding my weirdo shit, because of fear to fail, that same fear that one day i will dissappear. zachbachiri Best described via emojis (insert relevant emojis) zachbachiri It's kind of like a mad jumble. It all moves so fast. Bouncing around my head. I'm trying to slow it down so I can focus on that things are actually really good for me right now. zachbachiri Defective at best zachbachiri I feel like a mother waiting to hold her baby for the first time, like a child waiting for her mother after school. zachbachiri I feel okay, had a falling out with an old friend but a new one cemented her status as my favorite person. So not bad.  zachbachiri skeptical. zachbachiri chuffed zachbachiri Depressed and longing for love zachbachiri I feel insanely relieved that I will get to see CB in Denver on NOT ELECTION NIGHT so I can enjoy the show without the deathly fear of impending doom. Well, the doom is still here. We've just learned to live with it. Maybe that's worse. zachbachiri bleh, man zachbachiri Content but fragile zachbachiri melancholic and sad zachbachiri I feel like no one my age knows what good music is.. and thinks I'm crazy for liking a lot of music and I also feel like no one is praying for me zachbachiri Like listening to the Fall zachbachiri I'm tired. Working two jobs really takes it out of you. I love my wife and dog though, so at the end of the day it's a contented kind of tired. Also the rum helps. zachbachiri Satisfied! zachbachiri I feel so anxious about my graduation design project!! It cause too many pressure zachbachiri like i’m waiting for something to happen and for things to get better and it doesn’t  zachbachiri I feel like I'm falling apart just a little bit, I haven't seen my partner in a month and I won't for another two zachbachiri certainly uncertain about who's behind the curtain zachbachiri i'm feeling a little sleepy, tbh. but mostly excited about some new cb tunes! zachbachiri Just a bit stressed. I am writing a play for high schools across Australia about anti bullying  and the theatre company I am working with wants it by Friday. I should get it done though zachbachiri Gassy zachbachiri I feel like things can tear apart really easily, but at the moment I feel okay and that's something to hold on to. zachbachiri I'm alright. zachbachiri Riding a number 12 tram into Melbourne for White Night, feeling lucky to live in this great city zachbachiri pretty OK zachbachiri anxious zachbachiri I feel sad because my dog is ill. She will probably die in a year or less and she is my best friend. Plus I'm starting to not loving my job anymore. I need a little time now.  zachbachiri Quite shitty, and totally useless at most times zachbachiri nameless, faceless zachbachiri I'm feeling myself grow into something I never wanted to be. zachbachiri I feel great, but... zachbachiri I feel so unsure right now. About everything. It's like I don't really know myself the way I thought I did. zachbachiri I want more winter. zachbachiri Tipsy & confused  zachbachiri I miss my dad zachbachiri I feel fed up with the amount of money I need to pay for post-secondary education. zachbachiri I cannot wait to see another show of yours! zachbachiri Well, I just got home from work and feeling a bit worn down.  My legs are sore from working out the last couple days. And I'm really excited to (possibly) be getting some new music from you! zachbachiri i feel like my whole world is crashing down around me and the least i can do is support others while my life falls to pieces, other than that i feel pretty great. zachbachiri Cake in the oven and German in my brain. zachbachiri Wondering where all the time goes. zachbachiri Not all that great. Worried about the socio-political environment in the world. And I'm hungry and could use some caffeine. zachbachiri I saw some of these are going up on street walls. Hi mum! zachbachiri I am actually really scared of people??? like I just want to be chill but fuck socializing is so hard sometimes. That's why I'm so grateful for my friends.  zachbachiri Overlooked. zachbachiri I feel like my internally mood is pouring rain I FEEL FREE zachbachiri i feel like shit zachbachiri Blissfull when I hear your voice. zachbachiri Drowsy zachbachiri i feel like i can grow as tall as a tree if i really wanted to. but i dont really want to, im fine with how tall i am right now zachbachiri caustic. deserted. spirited. lethargic. paradoxical. sympathetic. callous. devoted. diffident. silly. open. zachbachiri Stressed out. Too much to do, too little time to do it. Just on the verge of losing it... zachbachiri At the moment, I feel happy & really comfortable in my own skin. Which is to say there are a lot of times I'm not. zachbachiri Mainly overwhelmed & wavy ‚ floating around pretty untethered, too much drinking, too many feelings. Lol!  zachbachiri Glowing zachbachiri pretty good I guess thanks for asking, how are you? zachbachiri Like the trees of a battlefield. Stuck in the moment, catching the crossfire, patiently waiting for death so I can go back to worshipping the sun. zachbachiri Drunk and empty. zachbachiri irreparably broken zachbachiri Full zachbachiri I am treading water zachbachiri I feel empty. Like I will never find what makes me feel whole. zachbachiri Sometimes I feel bad, sometimes I feel good. I guess the power of choice's in my own hands, I guess I never thought it would be.  zachbachiri The depression is preventing me from from feeling anything, really.  zachbachiri I feel unwanted zachbachiri I feel sad & a little depressed but I know that this feeling will go away and it's not forever. :) zachbachiri I feel angry and sad and I'm fed up with all this fuckin nonsense! zachbachiri I feel like nobody gives me time anymore. I’m ever so lonely. zachbachiri I feel like I should have died instead of my mom zachbachiri These things make me happy zachbachiri feelin' pretty damn good! zachbachiri I'M FUCKING PUMPED IF THIS IS A NEW ALBUM. THAT'S HOW I FUCKING FEEL! zachbachiri good zachbachiri I am a bisexual girl in a long term relationship with a man but I ache for the touch and love of a woman  zachbachiri Pretty angry and stressed right now. House-Hunting in Dublin is soul-crushingly annoying when you've been landed in this situation rather than willingly looking to move house on your own terms. zachbachiri Cooped up and tired zachbachiri Anxious and restless.  Reality of divorce and absent husband kicking in. It feels real. Not a holiday anymore. after relief of getting away, pause to rest, now finding myself. Shit scary, empty, humbling. Like leaning over a cliff, alone, breathing zachbachiri Crappy zachbachiri It was a long, bumpy road for my wife and I to be able to be together. But I did whatever I had to do, including driving a lemon of a car across the country, to be with her. zachbachiri Good zachbachiri I'm still in love with Rosalie zachbachiri hungover zachbachiri thoughtful zachbachiri I'm just waiting for life to start, but it won't start until I've figured out what I want. zachbachiri Happy where I am but still restless and puzzled by the concept of 'feeling at home'. zachbachiri Feeling a little sleepy, but I hope the sugar rush will kick in real soon. zachbachiri sleepy, sad, reminiscient  zachbachiri anxious zachbachiri Most of the time I feel too sad to cry but when I'm thinking about you and listening to your music it's okay. zachbachiri I don't know man, its like I'm not even living sometimes... zachbachiri I used to hate myself, but now I think I'm alright. zachbachiri My head hurts but the migraine has stopped for now. It might come back but I won't know 'till tomorrow zachbachiri Trapped. My mind, ideas and aspirations are trapped in a body suffering crippling anxiety and depression. So many goals, so little enthusiasm to see them through. zachbachiri I seem to think a lot about the things that I forgot to do, and all the times I had a chance to. Please don't confront me with my failures, I had not forgotten them. Nico is how I feel right now. zachbachiri Feel ready for a new Courtney Barnett album... zachbachiri I feel under-appreciated. zachbachiri Fucking EXCITED about this song zachbachiri sometimes like a pitcher with only half of the good stuff, trying to get a feel; sometimes the baseball, rocking and wobbling home zachbachiri Wishing I wasn't broke but really its been a lovely day. The cat jumped up on the sofa when I asked her to. zachbachiri stressed, because I should be writing a midterm paper on subjects and citizens but I am on this website instead  zachbachiri I feel a little misunderstood but it's all right; it is always all right. zachbachiri I can't say zachbachiri Tired, excited, anxious, happy, lucky zachbachiri Cautiously optimistic about the day ahead zachbachiri Tired of the internet zachbachiri Wish I knew zachbachiri inundated by imposter syndrome zachbachiri I'm in love. zachbachiri sleepy, sad, reminiscient  zachbachiri Anxious zachbachiri I feel complacent. zachbachiri I feel like punching a wall. but I can't because I punched one last night and now my hand is black and blue. zachbachiri sleepy af zachbachiri dead tired of the rat race zachbachiri I am almost done with school, but not sure what to do about it. I have a girl whom I love, but I'm not sure if she loves me back.  zachbachiri Undermined  zachbachiri Pulchritudinous. zachbachiri I feel...not much at the moment if we're being honest zachbachiri Stoked zachbachiri Sometimes I feel really outside myself, but inside everything. I find the paradox interestingly funny and tend to roll with it, as it doesn't scare me much anymore. zachbachiri idk rn I'm feeling pretty good zachbachiri Great! zachbachiri Feliz, porque al fin podre escuchar el nuevo disco zachbachiri I feel unsure what to write zachbachiri urgh zachbachiri Cooped up and tired zachbachiri I'm feeling fucking shit,,, I'm going through a breakup, if you can even call it that, I just wanna destroy my phone and move to like Fiji or somethin. Fuck. I'm excited for your new song.  zachbachiri I'm pretty tired, just got home from the restaurant I work at. zachbachiri I feel oppressed. Tired of not telling people what I really think about them. Especially my family. They're always telling me what to do, how to dress, how to react. They control every single part of my life. I cut my own hair yesterday and I really feel like no one really likes it. I feel real angry sometimes aswell but also sometimes just the best, I'm not sure how I really feel but I hope that you feel happy. zachbachiri I don't know what I want to make with my life, I'm 23 and I feel like it's too late zachbachiri Wired zachbachiri Slightly bloated, with a weird rash I'm worried about. zachbachiri holy shit i love you zachbachiri God zachbachiri I feel like running through that brick wall to get to the other side. But I also feel like laying down next to the wall and taking a nap. Maybe I'll take a quick nap then climb over the wall. zachbachiri Lovely zachbachiri i feel like i get so wrapped up in orbiting the miniature universe that is my friend group that i forget that we're not a representative sample of the whole population. it's weird to be reminded that we're in the minority zachbachiri Melancholic zachbachiri Anxious. zachbachiri I am curious and let down and happy zachbachiri with my hands usually. actually no, melancholic. zachbachiri I'm feeling pretty great zachbachiri Bored, Courtney. I need something in sync with boredom, something witty and stupid at the same time ie your new album. Please.  zachbachiri I feel like the end is near zachbachiri I can't tell if I'm sad or if I need to book an eye test zachbachiri Anxious zachbachiri Tired & Gay. zachbachiri oh boy....I feel STOKED if this means you're putting out new tunes!!!!!! but in all seriousness you're the rockstar I want to be zachbachiri Fucking amazing. zachbachiri Your hair looks really cool. Like the bangs part of it I mean. And I love the way you use words. zachbachiri I really feel I need a haircut. zachbachiri I'm uncertain about my future: where I'll be living, who I'll be dating, whether or not I'll still have the same friends. I'm afraid of everything that's going on in the world. But I'm hopeful that everything and everyone will be okay. zachbachiri My head hurts, and I'm just feeling a little sick right now, but otherwise Generally uncomfortable zachbachiri halfway between miserable and exhilarating. zachbachiri a little giddy! zachbachiri I want to create something beautiful zachbachiri Able, powerful and ready ... yet afraid, alone and helpless";
rawData = rawData.toUpperCase();
var cbData = rawData.split(" ZACHBACHIRI ");
var aString = b.loadString("afinn-111.json");
var afinn = b.JSON.decode(aString);


function draw() {
	var cities = [
	{
		"name" : "Portland",
		"date" : "July 26, 2018",
		"location" : "State Theatre",
		"population" : 66882,
		"land_area" : 69.44, //mi^2
		"density" : 963,
		"responses" : cbData,
		"position" : [0,0]
		//["i feel good!", "Simultaneously inspired and frustrated - so much that it keeps me awake.", "Ready", "Lost", "I feel a little tired and hungry and stoned", "It varies, but currently alright.", "I love you, you're the best", "actually pretty good. been teaching music, playing a few shows and living in Austin texas. how are you?", "Sad. But ain't that how it always goes.", "Almost completely in love", "i feel homesick or maybe just hungry", "I little bit tired and hungry, but ready to get off work and have some fun.", "Right now I feel a little worn out from my kids not settling down tonight and letting my wife and I relax a bit after working all day.", "Today will be a better day. If yesterday was good, then today will be just as good if not better.", "Abandoned, but forced to go through the motions of belonging."]
	} , 
	{
		"name" : "San Diego",
		"date" : "October 3, 2018",
		"location" : "Observatory North Park",
		"population" : 1420000,
		"land_area" : 372.4,
		"density" : 3813,
		"responses" : cbData,
		"position" : [1,0]
	} , 
	{
		"name" : "Los Angeles",
		"date" : "October 5, 2018",
		"location" : "Greek Theatre",
		"population" : 4000000,
		"land_area" : 503,
		"density" : 7952,
		"responses" : cbData,
		"position" : [2,0]
	},  
	{
		"name" : "Chicago",
		"date" : "October 18, 2019",
		"location" : "Riviera Theatre",
		"population" : 2687000,
		"land_area" : 234,
		"density" : 11482,
		"responses" : cbData,
		"position" : [0,1]
	} ,  
	{
		"name" : "Pittsburgh",
		"date" : "October 19, 2019",
		"location" : "Stage AE",
		"population" : 302407,
		"land_area" : 58.35,
		"density" : 5182,
		"responses" : cbData,
		"position" : [1,1]
	} ,  
	{
		"name" : "Boston",
		"date" : "October 21, 2019",
		"location" : "House of Blues",
		"population" : 685094,
		"land_area" : 89.63,
		"density" : 7643,
		"responses" : cbData,
		"position" : [2,1]
	} ,
	{
		"name" : "Brooklyn",
		"date" : "October 22, 2018",
		"location" : "Brooklyn Steel",
		"population" : 2649000,
		"land_area" : 69.5,
		"density" : 38115,
		"responses" : cbData,
		"position" : [0,2]
	} ,  
	{
		"name" : "Philadelphia",
		"date" : "October 23, 2019",
		"location" : "The Fillmore",
		"population" : 1581000,
		"land_area" : 141.7,
		"density" : 11157,
		"responses" : cbData,
		"position" : [1,2]
	},  
	{
		"name" : "Nashville",
		"date" : "October 25, 2019",
		"location" : "Marathon Music Works",
		"population" : 1581000,
		"land_area" : 271.8,
		"density" : 11157,
		"responses" : cbData,
		"position" : [2,2]
	}];


  //Loop through cities
	for (var i = 0; i < 2/*cities.length*/; i++) {
    b.textFont('DIN 2014\tRegular');
    b.noStroke();
    b.rectMode(b.CORNER);
    	//set grid and text sizes based on density
		var x = b.round(b.map( cities[i].density, 500, 15000, 0, 4));
		if (x == 0) {
	    	var grid = b.width/2;
	    	var textSize = 40;
	      
	    }
    	if (x == 1) {
			var grid = b.width/4;
			var textSize = 30;
			
		}
		if (x == 2) {
			var grid = b.width/6;
			var textSize = 18;
			
		}
		if (x == 3) {
			var grid = b.width/8;
			var textSize = 14;
		}
		if (x > 4) {
			var grid = b.width/10;
			var textSize = 10;
		}
		/*if (x == 5) {
			var grid = b.width/12;
			var textSize = 9;
		}*/
		b.textSize(textSize);

		var imgPos = [0-(b.width*cities[i].position[0]), 0-(b.height*cities[i].position[1])];
		var img = b.image("cb.jpg", imgPos[0], imgPos[1], b.width*3, b.height*3);
		img.geometricBounds = [0, 0, b.height, b.width];


  		var columns = b.round(b.width/grid);
  		var rows = b.round(b.height/grid);
  		
  		//grid exclusion variables (indicates when to skip a grid item because double-width was previously created)
  		var jEx = 0;
  		var kEx = 0;

      //Draw rects and text boxes
  		var textBoxes = [];
  		for (var j = 0; j<rows; j++) {
  			for (var k = 0; k<columns; k++) {
  				var gSize = grid-(grid*.1);
  				var gX = (grid*k)+(grid*.05);
  				var gY = (grid*j)+(grid*.05);
  				var tbSize = grid-(grid*.2);
  				var tbX = (grid*k)+(grid*.1);
  				var tbY = (grid*j)+(grid*.1);
  				var opc = 15;
  				//set top left box
  				if(j+k == 0) {
  					b.fill(255,255,255);
  					b.opacity(b.rect(gX, gY, gSize, gSize), opc);
  					b.image("tellme.png", tbX, tbY, tbSize, tbSize);

  				// set botom left box
  				} else if(j+1 == rows && k == 0) {
  					b.fill(255,255,255);
  					b.opacity(b.rect(gX, gY, gSize, gSize), opc);
  					b.image("logo2.png", tbX, tbY, tbSize, tbSize);

  				// set date,time,venue
  				} else if ((j+1)*(k+1) == columns*rows) {
  					b.textAlign(Justification.LEFT_ALIGN, VerticalJustification.CENTER_ALIGN);
  					b.textFont('DIN 2014\tDemi');
  					b.fill(255,255,255);
  					b.opacity(b.rect(gX, gY, gSize, gSize), opc);
  					b.fill(255,50,50);
  					b.rotate(-(b.PI/2));
  					b.textSize(textSize*1.3);
  					b.text(cities[i].name.toUpperCase() + "\n" + cities[i].date.toUpperCase() + "\n" + cities[i].location.toUpperCase(), tbX, tbY+tbSize, tbSize, tbSize);
  					b.textSize(textSize);
  					b.rotate(0);
  					b.textAlign(Justification.LEFT_ALIGN, VerticalJustification.TOP_ALIGN);

  					//enter if this item isn't excluded by previous item
  				} else if (!(jEx == j && kEx == k)) {
  					// enter based on randomness and not last column, creates double width box
  					if (b.random(0,10)>9 && k != columns-1 && !(rows == j+1 && columns == k+2)) {
  						jEx = j;
  						kEx = k+1;
  						b.textAlign(Justification.LEFT_ALIGN, VerticalJustification.CENTER_ALIGN);

  						var txt = cities[i].responses[b.round(b.random(cities[i].responses.length-1))];
	  					var txtArray = txt.split(/\W/);
	  					var sentiment = getSentiment(txtArray);

	  					var offSetAbs = b.map(sentiment,-5,5,-(grid*.5),(grid*.5));
	  					var offsetX = b.random(-offSetAbs,offSetAbs);
	  					var offsetY = b.random(-offSetAbs,offSetAbs);
	  					img = b.image("cb.jpg", imgPos[0]+offsetX, imgPos[1]+offsetY, b.width*3, b.height*3);
						img.geometricBounds = [gY, gX, gY+gSize, gX+(gSize*2+grid*.1)];
	  					b.fill(255,255,255);
	  					b.opacity(b.rect(gX, gY, gSize*2+grid*.1, gSize), opc);
						b.textSize(textSize*1.2);
			            var txtBox = b.text(txt, tbX, tbY, tbSize*2+grid*.2, tbSize);
			            b.textSize(textSize);
	  					b.typo(txtBox, "skew", sentiment*10);
	  					b.textAlign(Justification.LEFT_ALIGN, VerticalJustification.TOP_ALIGN);

	  					// otherwise create a normal text box
	  				} else if (b.random(0,10)>3) {
  						var txt = cities[i].responses[b.round(b.random(cities[i].responses.length-1))];
	  					var txtArray = txt.split(/\W/);
	  					var sentiment = getSentiment(txtArray);

	  					var offSetAbs = b.map(sentiment,-5,5,-(grid*.5),(grid*.5));
	  					var offsetX = b.random(-offSetAbs,offSetAbs);
	  					var offsetY = b.random(-offSetAbs,offSetAbs);
	  					img = b.image("cb.jpg", imgPos[0]+offsetX, imgPos[1]+offsetY, b.width*3, b.height*3);
						img.geometricBounds = [gY, gX, gY+gSize, gX+gSize];
	  					b.textSize(textSize);
	  					b.fill(255,255,255);
	  					b.opacity(b.rect(gX, gY, gSize, gSize), opc);
			            
			              	var txtBox = b.text(txt, tbX, tbY, tbSize, tbSize);

	  						b.typo(txtBox, "skew", sentiment*10);
  					}
  				}
  			}
  		}
  		if (i != cities.length-1) b.addPage();
	}


}

b.go();

function getSentiment(x) {
	var score = 0.0;
	var words = 0.0;
	for (var i = 0; i < x.length; i++) {
		if (afinn.hasOwnProperty(x[i].toLowerCase())) {
			score += Number(afinn[x[i].toLowerCase()]);
			words = words+1.0;
		}
	}
  if (words != 0) {
    score = score/words;
  }
	
	return score;
}